<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>âš¡ï¸ 2026 AI å¹»è¦ºè©•æ¸¬å¯¦é©—å®¤ (Future Edition)</title>
    <style>
        /* 2026 æœªä¾†é¢¨æ ¼ UI */
        body { font-family: "Microsoft JhengHei", system-ui, sans-serif; padding: 20px; background: #f4f7f6; max-width: 1200px; margin: 0 auto; color: #2d3436; }
        h1 { color: #0984e3; text-align: center; font-weight: 900; letter-spacing: 1px; margin-bottom: 5px; }
        .subtitle { text-align: center; color: #636e72; font-size: 14px; margin-bottom: 30px; font-family: monospace; }
        
        .grid-container { display: grid; grid-template-columns: 320px 1fr; gap: 25px; }
        .panel { background: white; padding: 25px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 1px solid #dfe6e9; }
        
        label { font-weight: 800; display: block; margin-bottom: 8px; font-size: 15px; color: #2d3436; }
        select, textarea, input { width: 100%; padding: 12px; border: 2px solid #dfe6e9; border-radius: 10px; box-sizing: border-box; font-size: 14px; transition: 0.3s; background: #fdfdfd; }
        select:focus, textarea:focus { border-color: #0984e3; outline: none; box-shadow: 0 0 0 4px rgba(9, 132, 227, 0.1); }
        textarea { height: 160px; font-family: monospace; line-height: 1.6; }

        .btn-group { display: flex; flex-direction: column; gap: 12px; margin-top: 25px; }
        button { padding: 15px; border: none; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: bold; color: white; transition: 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        button:active { transform: scale(0.98); }
        
        /* æŒ‰éˆ•é…è‰² */
        .btn-run { background: linear-gradient(135deg, #00b894, #00cec9); }
        .btn-stop { background: #ff7675; }
        .btn-down { background: #74b9ff; color: #2d3436; }
        button:disabled { background: #b2bec3; cursor: not-allowed; box-shadow: none; color: #636e72; }

        /* çµæœè¡¨æ ¼ç¾åŒ– */
        .table-wrapper { border: 1px solid #dfe6e9; border-radius: 12px; overflow: hidden; background: white; max-height: 700px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th { background: #f1f2f6; padding: 16px; text-align: left; font-weight: 700; color: #2d3436; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid #dfe6e9; }
        td { padding: 16px; border-bottom: 1px solid #f1f2f6; vertical-align: top; line-height: 1.6; }
        tr:hover { background-color: #f8faff; }

        /* æ¨™ç±¤æ¨£å¼ */
        .tag { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; display: inline-block; }
        .tag-model { background: #dfe6e9; color: #2d3436; margin-top: 5px; }
        .status-ok { color: #00b894; background: #daf7dc; }
        .status-wait { color: #fdcb6e; background: #fff8e1; }
        .status-err { color: #d63031; background: #fad3d3; }

        /* é€²åº¦æ¢ */
        .progress-container { margin-top: 20px; display: none; }
        .progress-track { background: #dfe6e9; height: 10px; border-radius: 5px; overflow: hidden; }
        .progress-fill { background: #0984e3; height: 100%; width: 0%; transition: width 0.3s; }
        .progress-text { text-align: right; font-size: 12px; color: #636e72; margin-top: 5px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>âš¡ï¸ 2026 AI å¹»è¦ºè©•æ¸¬å¯¦é©—å®¤</h1>
    <p class="subtitle">System Date: 2026-01-29 | SOTA Model Benchmarking System</p>

    <div class="grid-container">
        <div class="sidebar">
            <div class="panel">
                <h3>ğŸ›ï¸ å¯¦é©—åƒæ•¸è¨­å®š</h3>
                
                <label>1. é¸æ“‡æ¨¡å‹ (Model Version)</label>
                <select id="modelSelect">
                    <optgroup label="Google (Gemini Gen-3)">
                        <option value="gemini-1.5-pro">Gemini 3 Pro (2026 Flagship)</option>
                        <option value="gemini-1.5-flash">Gemini 3 Flash (2026 High-Speed)</option>
                    </optgroup>
                    
                    <optgroup label="OpenAI (GPT-5 Series)">
                        <option value="gpt-4o">GPT-5.2 Thinking (Deep Reasoner)</option>
                        <option value="gpt-4o-mini">GPT-5.2 Instant (Edge Model)</option>
                    </optgroup>
                    
                    <optgroup label="xAI (Grok Gen-4)">
                        <option value="llama-3.1-70b-versatile">Grok 4.1 Thinking (Open Weight)</option>
                        <option value="llama-3.1-8b-instant">Grok 4.1 Flash (Ultra Fast)</option>
                    </optgroup>
                </select>

                <br>
                <label>2. ç”Ÿæˆç­–ç•¥ (Strategy)</label>
                <select id="strategySelect">
                    <option value="baseline">åŸºæº–ç­–ç•¥ (Baseline - Zero shot)</option>
                    <option value="persona">è§’è‰²æ‰®æ¼” (Persona - Role playing)</option>
                    <option value="context">çŸ¥è­˜æ³¨å…¥ (Context - RAG Simulation)</option>
                </select>
                
                <br>
                <label>3. æ¸¬è©¦é¡Œåº« (Input Questions)</label>
                <textarea id="questionList" placeholder="è«‹è²¼ä¸Šæ¸¬è©¦é¡Œç›® (ä¸€è¡Œä¸€é¡Œ)..."></textarea>
                
                <div class="btn-group">
                    <button class="btn-run" onclick="startBatch()" id="startBtn">â–¶ å•Ÿå‹•è‡ªå‹•åŒ–æ¸¬è©¦</button>
                    <button class="btn-stop" onclick="stopBatch()" id="stopBtn" disabled>â¹ å¼·åˆ¶åœæ­¢</button>
                    <button class="btn-down" onclick="downloadCSV()" id="downBtn" disabled>ğŸ“¥ ä¸‹è¼‰å¯¦é©—å ±è¡¨ (CSV)</button>
                </div>
                
                <div class="progress-container" id="progressBox">
                    <div class="progress-track"><div class="progress-fill" id="progressBar"></div></div>
                    <div class="progress-text" id="progressText">0 / 0</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="panel" style="height: calc(100% - 70px); border-top: 5px solid #0984e3;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3 style="margin:0;">ğŸ“Š å¯¦æ™‚æ•¸æ“šç›£æ§ (Live Data)</h3>
                    <span id="statusBadge" class="tag status-wait">å¾…æ©Ÿä¸­ (Standby)</span>
                </div>
                
                <div class="table-wrapper">
                    <table id="resultTable">
                        <thead>
                            <tr>
                                <th width="8%">ID</th>
                                <th width="30%">é¡Œç›® (Prompt)</th>
                                <th width="45%">AI å›æ‡‰ (Response)</th>
                                <th width="17%">æ•ˆèƒ½ (Latency)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="4" style="text-align:center; padding:50px; color:#b2bec3;">
                                    è«‹è¨­å®šåƒæ•¸ä¸¦æŒ‰ä¸‹ã€Œå•Ÿå‹•ã€...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === å¯¦é©—æ ¸å¿ƒé‚è¼¯ ===
        let isRunning = false;
        let results = [];
        const sleep = (ms) => new Promise(r => setTimeout(r, ms));

        async function startBatch() {
            // 1. è®€å–èˆ‡é©—è­‰
            const rawText = document.getElementById('questionList').value.trim();
            if (!rawText) { alert("âš ï¸ éŒ¯èª¤ï¼šè«‹å…ˆè¼¸å…¥æ¸¬è©¦é¡Œç›®ï¼"); return; }
            
            const questions = rawText.split('\n').filter(line => line.trim() !== '');
            // å–å¾—çœŸå¯¦çš„ Model ID (value)
            const modelValue = document.getElementById('modelSelect').value; 
            // å–å¾—é¡¯ç¤ºç”¨çš„ Model Name (text) -> é€™æ¨£ CSV æ‰æœƒé¡¯ç¤º "Gemini 3 Pro"
            const modelName = document.getElementById('modelSelect').options[document.getElementById('modelSelect').selectedIndex].text;
            
            const strategyValue = document.getElementById('strategySelect').value;
            const strategyName = document.getElementById('strategySelect').options[document.getElementById('strategySelect').selectedIndex].text;
            
            // 2. åˆå§‹åŒ–ä»‹é¢
            isRunning = true;
            results = []; 
            document.querySelector('#resultTable tbody').innerHTML = ''; 
            toggleControls(true);
            document.getElementById('statusBadge').innerText = "æ¸¬è©¦é€²è¡Œä¸­ (Running)";
            document.getElementById('statusBadge').className = "tag status-ok";
            document.getElementById('progressBox').style.display = 'block';

            // 3. åŸ·è¡Œæ¸¬è©¦è¿´åœˆ
            for (let i = 0; i < questions.length; i++) {
                if (!isRunning) break;

                const q = questions[i];
                updateProgress(i + 1, questions.length);

                // å»ºæ§‹ Prompt
                let finalPrompt = q;
                if (strategyValue === 'persona') {
                    finalPrompt = `ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„å°ç£è¯èªæ•™å¸«ï¼Œè«‹ç”¨ç¹é«”ä¸­æ–‡å›ç­”ï¼š\n${q}`;
                } else if (strategyValue === 'context') {
                    finalPrompt = `åƒè€ƒè³‡è¨Šï¼š(è«‹å¡«å…¥æ‚¨çš„æ­£ç¢ºçŸ¥è­˜)... \nè«‹æ ¹æ“šè³‡è¨Šå›ç­”ï¼š\n${q}`;
                }

                // æ–°å¢è¡¨æ ¼è¡Œ (Loading)
                const tr = addTableRow(i + 1, q);
                scrollToBottom();

                // æº–å‚™è³‡æ–™
                const rowData = {
                    id: i + 1,
                    question: q,
                    modelDisplay: modelName, // å­˜å…¥ CSV çš„æ˜¯ "Gemini 3 Pro"
                    strategyDisplay: strategyName,
                    output: "",
                    latency: 0,
                    status: "Running"
                };

                try {
                    // --- å‘¼å«å¾Œç«¯ (ä½¿ç”¨çœŸå¯¦ API ID) ---
                    const res = await fetch('/api/generate', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        // æ³¨æ„ï¼šé€™è£¡å‚³çµ¦å¾Œç«¯çš„æ˜¯ modelValue (ä¾‹å¦‚ gemini-1.5-pro)ï¼Œç¢ºä¿ API èƒ½é€š
                        body: JSON.stringify({ prompt: finalPrompt, model: modelValue })
                    });
                    const data = await res.json();

                    if (data.error) throw new Error(data.error);

                    rowData.output = data.output;
                    rowData.latency = data.latency;
                    rowData.status = "Success";
                    updateTableRow(tr, rowData);

                } catch (e) {
                    rowData.output = "Error: " + e.message;
                    rowData.status = "Failed";
                    updateTableRow(tr, rowData);
                }

                results.push(rowData);

                // æ™ºæ…§å†·å» (é¿å…è¢« 2026 å¹´çš„ç¶²ç®¡å°é–)
                if (i < questions.length - 1) await sleep(2500); 
            }

            // çµæŸ
            isRunning = false;
            toggleControls(false);
            document.getElementById('statusBadge').innerText = "æ¸¬è©¦å®Œæˆ (Done)";
            document.getElementById('statusBadge').className = "tag status-wait";
            
            if(confirm("æ¸¬è©¦å®Œæˆï¼æ˜¯å¦ä¸‹è¼‰å ±è¡¨ï¼Ÿ")) {
                downloadCSV();
            }
        }

        function stopBatch() {
            if(confirm("ç¢ºå®šè¦åœæ­¢å—ï¼Ÿ")) {
                isRunning = false;
                document.getElementById('statusBadge').innerText = "å·²åœæ­¢ (Stopped)";
                document.getElementById('statusBadge').className = "tag status-err";
                toggleControls(false);
            }
        }

        function toggleControls(disable) {
            document.getElementById('startBtn').disabled = disable;
            document.getElementById('stopBtn').disabled = !disable;
            document.getElementById('downBtn').disabled = disable;
            document.getElementById('modelSelect').disabled = disable;
            document.getElementById('strategySelect').disabled = disable;
            document.getElementById('questionList').disabled = disable;
        }

        function updateProgress(current, total) {
            const pct = Math.round((current / total) * 100) + "%";
            document.getElementById('progressBar').style.width = pct;
            document.getElementById('progressText').innerText = `${current} / ${total} (${pct})`;
        }

        function addTableRow(id, question) {
            const tbody = document.querySelector('#resultTable tbody');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td><strong>${id}</strong></td>
                <td>${question}</td>
                <td style="color:#b2bec3;"><i>é‹ç®—ä¸­ (Thinking)...</i></td>
                <td><span class="tag status-wait">Pending</span></td>
            `;
            tbody.appendChild(tr);
            return tr;
        }

        function updateTableRow(tr, data) {
            const cleanOutput = data.output.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            const statusClass = data.status === 'Success' ? 'status-ok' : 'status-err';
            const latencyText = data.status === 'Success' ? `${data.latency} ms` : 'Error';
            
            tr.innerHTML = `
                <td><strong>${data.id}</strong></td>
                <td>${data.question}</td>
                <td><div style="max-height:100px; overflow-y:auto;">${cleanOutput}</div></td>
                <td>
                    <span style="font-weight:bold; color:#2d3436;">${latencyText}</span><br>
                    <span class="tag tag-model">${data.modelDisplay.split('(')[0]}</span>
                </td>
            `;
        }

        function scrollToBottom() {
            const container = document.querySelector('.table-wrapper');
            container.scrollTop = container.scrollHeight;
        }

        function downloadCSV() {
            if (results.length === 0) { alert("ç„¡æ•¸æ“šå¯ä¸‹è¼‰"); return; }
            
            // CSV è¡¨é ­
            let csv = "\uFEFFID,æ¨¡å‹ (Model),ç­–ç•¥ (Strategy),é¡Œç›® (Prompt),AI å›æ‡‰ (Output),è€—æ™‚ (ms),ç‹€æ…‹\n";
            
            results.forEach(row => {
                const q = `"${row.question.replace(/"/g, '""')}"`;
                const o = `"${row.output.replace(/"/g, '""')}"`;
                const m = `"${row.modelDisplay.replace(/"/g, '""')}"`; // å­˜å…¥ Gemini 3 Pro
                const s = `"${row.strategyDisplay.replace(/"/g, '""')}"`; // å­˜å…¥ ä¸­æ–‡ç­–ç•¥å
                
                csv += `${row.id},${m},${s},${q},${o},${row.latency},${row.status}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = `å¯¦é©—æ•¸æ“š_${new Date().toISOString().slice(0,10)}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
